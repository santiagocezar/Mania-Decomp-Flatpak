app-id: com.decomp.RSDKv5
runtime: org.freedesktop.Platform
runtime-version: "21.08"
sdk: org.freedesktop.Sdk
command: run.sh
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --socket=pulseaudio
  - --filesystem=~/.steam:ro
  - --filesystem=~/.var/app/com.valvesoftware.Steam:ro
  - --persist=.
  - --device=all
modules:
  - glfw.yaml
  - shared-modules/glew/glew.json
  - shared-modules/glu/glu-9.json
  - name: mania
    no-autogen: true
    no-make-install: true
    make-args:
      - STATIC=0
    post-install:
      - install -Dp -m 755 bin/Linux/SonicMania.so /app/lib/Game.so
    sources:
      - type: git
        url: https://github.com/Rubberduckycooly/Sonic-Mania-Decompilation.git
        disable-submodules: true
        branch: master
  - name: rsdkv5
    no-autogen: true
    no-make-install: true
    make-args:
      - RSDK_ONLY=1
      # probably it was only -fsigned-char what whas causing problems but just in case
      - CXXFLAGS=
      - AUTOBUILD=1
    post-install:
      - install -Dp -m 755 bin/Linux/GL3/RSDKv5 /app/bin/RSDKv5
      - install -Dp -m 644 com.decomp.RSDKv5.desktop /app/share/applications/com.decomp.RSDKv5.desktop
      - install -Dp -m 644 com.decomp.RSDKv5.png /app/share/icons/hicolor/256x256/apps/com.decomp.RSDKv5.png
      - install -Dp -m 644 com.decomp.RSDKv5.appdata.xml /app/share/appdata/com.decomp.RSDKv5.appdata.xml
    sources:
      - type: git
        url: https://github.com/Rubberduckycooly/RSDKv5-Decompilation.git
        branch: master
      - type: file
        path: com.decomp.RSDKv5.desktop
      - type: file
        path: com.decomp.RSDKv5.png
      - type: file
        path: com.decomp.RSDKv5.appdata.xml
  - name: run
    buildsystem: simple
    build-commands:
      - install -Dp -m 755 run.sh /app/bin/run.sh
    sources:
      - type: file
        path: run.sh
